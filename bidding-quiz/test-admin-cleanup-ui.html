<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Cleanup UI Test</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-info {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-controls {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h1>Admin Cleanup UI Test</h1>
        <p>This page tests the admin cleanup panel UI components.</p>
        <ul>
            <li>Data usage stats display (player count, round count)</li>
            <li>Manual cleanup button</li>
            <li>Cleanup status messages</li>
            <li>Real-time stats updates</li>
        </ul>
    </div>

    <div class="test-controls">
        <h2>Test Controls</h2>
        <button id="show-admin-panel">Show Admin Panel</button>
        <button id="update-stats">Update Stats (5 players, 3 rounds)</button>
        <button id="show-success">Show Success Message</button>
        <button id="show-error">Show Error Message</button>
        <button id="simulate-cleanup">Simulate Cleanup</button>
    </div>

    <div id="admin-container"></div>

    <script type="module">
        import { UIManager } from './js/ui.js';
        import { GameState } from './js/game-state.js';

        const uiManager = new UIManager('test-room');
        const gameState = new GameState('test-room');

        // Show admin panel
        document.getElementById('show-admin-panel').addEventListener('click', () => {
            const adminPanel = document.getElementById('admin-panel');
            if (adminPanel) {
                adminPanel.remove();
            }
            
            const panelHTML = uiManager.renderAdminControls('waiting', 0);
            document.getElementById('admin-container').innerHTML = panelHTML;
            
            // Initialize cleanup controls
            uiManager.initializeCleanupControls(gameState, 'test-player-1');
            
            console.log('Admin panel displayed');
        });

        // Update stats
        document.getElementById('update-stats').addEventListener('click', () => {
            uiManager.updateDataUsageStats(5, 3);
            console.log('Stats updated to: 5 players, 3 rounds');
        });

        // Show success message
        document.getElementById('show-success').addEventListener('click', () => {
            uiManager.showCleanupSuccess(3);
            console.log('Success message displayed');
        });

        // Show error message
        document.getElementById('show-error').addEventListener('click', () => {
            uiManager.showCleanupError('Test error message');
            console.log('Error message displayed');
        });

        // Simulate cleanup
        document.getElementById('simulate-cleanup').addEventListener('click', async () => {
            console.log('Simulating cleanup...');
            
            // Update stats to show initial state
            uiManager.updateDataUsageStats(3, 5);
            
            // Wait 1 second
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Show cleanup in progress
            const cleanupBtn = document.getElementById('manual-cleanup-btn');
            if (cleanupBtn) {
                cleanupBtn.disabled = true;
                cleanupBtn.textContent = 'Cleaning up...';
            }
            
            // Wait 2 seconds
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Update stats to show cleanup complete
            uiManager.updateDataUsageStats(0, 5);
            uiManager.showCleanupSuccess(3);
            
            // Re-enable button
            if (cleanupBtn) {
                cleanupBtn.disabled = false;
                cleanupBtn.textContent = 'Cleanup Game Data';
            }
            
            console.log('Cleanup simulation complete');
        });

        console.log('Admin cleanup UI test loaded');
    </script>
</body>
</html>

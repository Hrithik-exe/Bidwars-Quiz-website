<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard Demo - Multiplayer Bidding Quiz</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <div id="error-container"></div>
        <div id="main-content">
            <h1 class="text-center">Leaderboard Demo</h1>
            
            <div style="max-width: 600px; margin: 0 auto;">
                <p class="player-count text-center">Loading player count...</p>
                
                <!-- Leaderboard Container -->
                <div id="leaderboard-container"></div>
                
                <div style="margin-top: 32px; text-align: center;">
                    <button id="add-player-btn">Add Random Player</button>
                    <button id="update-scores-btn">Update Random Scores</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK 10.7.1 from CDN -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, update } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        
        // Import Firebase configuration
        import { firebaseConfig, db } from './js/firebase-config.js';
        
        // Import UI Manager
        import { UIManager } from './js/ui.js';
        
        console.log('Firebase initialized successfully');
        
        // Initialize UI Manager
        const uiManager = new UIManager('room1');
        
        // Set a mock current player ID for demo
        uiManager.currentPlayerId = 'demo-player-1';
        
        // Initialize leaderboard listener
        uiManager.initializeLeaderboard();
        
        console.log('Leaderboard demo initialized');
        
        // Demo: Add random player
        document.getElementById('add-player-btn').addEventListener('click', async () => {
            const playerId = 'player-' + Math.random().toString(36).substr(2, 9);
            const names = ['Alice', 'Bob', 'Charlie', 'Diana', 'Eve', 'Frank', 'Grace', 'Henry'];
            const randomName = names[Math.floor(Math.random() * names.length)];
            const randomScore = Math.floor(Math.random() * 10000) + 1000;
            
            const playerRef = ref(db, `rooms/room1/players/${playerId}`);
            await set(playerRef, {
                name: randomName,
                score: randomScore,
                currentBid: 0,
                currentAnswer: null,
                isAdmin: false,
                joinedAt: Date.now()
            });
            
            console.log('Added player:', randomName, 'with score:', randomScore);
        });
        
        // Demo: Update random scores
        document.getElementById('update-scores-btn').addEventListener('click', async () => {
            const playersRef = ref(db, `rooms/room1/players`);
            const snapshot = await get(playersRef);
            
            if (snapshot.exists()) {
                const players = snapshot.val();
                const playerIds = Object.keys(players);
                const randomPlayerId = playerIds[Math.floor(Math.random() * playerIds.length)];
                const newScore = Math.floor(Math.random() * 10000) + 1000;
                
                const playerRef = ref(db, `rooms/room1/players/${randomPlayerId}`);
                await update(playerRef, { score: newScore });
                
                console.log('Updated player score:', randomPlayerId, 'to', newScore);
            }
        });
        
        // Import get function
        import { get } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
    </script>
</body>
</html>
